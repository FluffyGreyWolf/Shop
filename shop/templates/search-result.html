{% extends 'base.html' %}
{% block title %}Looking for: {{ searched }}{% endblock %}
{% load static %}
{% block content %}
<div class="page-container">
    <!-- menu with filter options -->
<div class="filters">
    <p>Filters</p>
    <div class="price-filter">
        <form method="GET" action="{% url 'search-result-price-filter' %}">
        <p class="filters-title">Price</p>
        <input class="price-input" type="search" placeholder="Min" name="price-min">
        <input class="price-input" type="search" placeholder="Max" name="price-max">
        <input class="price-input" type="hidden" value="{{ searched }}" name="products">

        <p class="filters-title" style="margin-top: 30px;">Order by:</p>
        <select name="price-order">
            {% if order == 'high' %}
            <option value="high">Highest price</option>
            <option value="low">Lowest price</option>
            {% elif order == 'low' %}
            <option value="low">Lowest price</option>
            <option value="high">Highest price</option>
            {% else %}
            <option value="high">---</option>
            <option value="high">Highest price</option>
            <option value="low">Lowest price</option>
          {% endif %}
        </select>
    </div>
    <button id="price-form-button" type="submit">Search</button>
</form>
</div>
<div class="product-list">
    <p class="result-title">Showing results for {{ searched }}:</p>

<!-- display of item list -->
{% if page %}
{% for product in page.object_list %}
<ul class="product">
    
    <li class="product-sublist">
        <img class="product-picture" src="{{ STATIC_URL }}{{ product.picture }}">
        <p class="product-name"><a class="nav-link nav-button" href="{% url 'product-detail' product.pk %}">{{ product.name }}</a></p>
        <p class="product-price">{{ product.price }}$</p>
            <a class="add-to-cart" href="{% url 'add-to-cart-buy' product.pk %}" type="submit">Buy now</a>
        
    </li>
</ul>
{% endfor %}
{% else %}
<p class="result-title" style="text-align: center;">We don't have these items</p>
<p><img src="{% static 'error.png' %}" width="100px" height="100px"></p>
{% endif %}

<!-- pagination buttons -->
    <div class="next-pages">
        {% if page.object_list.count == 0 %}
        <!-- there are no items -->
        {% elif page.number == 1 and page.has_next %}
        <!-- first page -->
        <a class="nav-link pagination-button page-active" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">1</a>
        -
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.next_page_number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.next_page_number }}</a>
        ...
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.paginator.num_pages  }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.paginator.num_pages }}</a>
        {% elif page.number == page.paginator.num_pages and page.number != 1 %}
        <!-- last page -->
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ 1 }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">1</a>
        ...
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.previous_page_number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.previous_page_number }}</a>
        -
        <a class="nav-link pagination-button page-active" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.number }}</a>
        {% elif page.number == 1 %}
        <!-- only one page of items -->
        {% else %}
        <!-- every other page -->
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ 1 }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">1</a>
        ...
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.previous_page_number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.previous_page_number }}</a>
        -
        <a class="nav-link pagination-button page-active" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.number }}</a>
        -
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.next_page_number }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.next_page_number }}</a>
        ...
        <a class="nav-link pagination-button" href="{% url 'search-result-price-filter' %}?search-form={{ searched }}&page={{ page.paginator.num_pages  }}&price-order={{ order }}&price-min={{ min }}&price-max={{ max }}&products={{ searched }}">{{ page.paginator.num_pages }}</a>
        {% endif %}


    </div>
</div>

</div>

{% endblock %}